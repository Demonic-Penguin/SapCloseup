{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-lg border-0 rounded-lg mt-4">
            <div class="card-header bg-primary text-white text-center py-4">
                <h1 class="display-5">
                    <i class="fas fa-cog me-3 animated-icon"></i>
                    SAP Connection Settings
                </h1>
            </div>
            <div class="card-body">
                <div class="text-center mb-4">
                    <p class="lead">Configure your SAP connection settings</p>
                    <p>Choose between Direct SAP Connection and Mock Data mode.</p>
                </div>
                
                <form method="POST" id="configForm" class="needs-validation" novalidate>
                    <div class="mb-4">
                        <label for="connection_type" class="form-label">Connection Type:</label>
                        <select class="form-select form-select-lg" id="connection_type" name="connection_type" required>
                            <option value="direct" {% if current_config.connection_type == 'direct' %}selected{% endif %}>Direct SAP Connection (Windows Only)</option>
                            <option value="mock" {% if current_config.connection_type == 'mock' %}selected{% endif %}>Mock Data (Development Mode)</option>
                        </select>
                        <div class="form-text">
                            <ul class="pt-2">
                                <li><strong>Direct Connection:</strong> Directly control SAP GUI without scripts or APIs (Windows only)</li>
                                <li><strong>Mock Data:</strong> Use for testing when SAP GUI is not available</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-save me-2"></i>
                            Save Configuration
                        </button>
                    </div>
                </form>
                
                <div class="card border-light mt-5">
                    <div class="card-body">
                        <h5 class="card-title text-primary">
                            <i class="fas fa-info-circle me-2"></i>
                            Setup Instructions
                        </h5>
                        
                        <div class="p-3 border rounded">
                            <h6 class="mb-3">Direct SAP Connection Setup</h6>
                            <p>The direct connection mode provides seamless automation without requiring script downloads:</p>
                            <ol>
                                <li>This application must be running on a Windows machine with SAP GUI installed</li>
                                <li>SAP GUI must have scripting enabled (see instructions below)</li>
                                <li>SAP GUI should be open with an active connection before using this application</li>
                                <li>Set the connection mode to "Direct SAP Connection"</li>
                                <li>The application will directly control SAP GUI without any script downloads</li>
                            </ol>
                            
                            <div class="alert alert-warning mb-3">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Important:</strong> This mode only works when running this application on Windows with SAP GUI installed. On other platforms, it will fall back to mock data mode.
                            </div>
                            
                            <div class="card bg-light mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0">How to Enable SAP GUI Scripting</h6>
                                </div>
                                <div class="card-body">
                                    <p>Follow these steps to enable SAP GUI Scripting:</p>
                                    <ol>
                                        <li>Open SAP GUI</li>
                                        <li>Go to "Customize Local Layout" (Alt+F12)</li>
                                        <li>Select the "Scripting" tab</li>
                                        <li>Check "Enable Scripting"</li>
                                        <li>Uncheck "Notify when a script attaches to a running SAP GUI"</li>
                                        <li>Click "OK" to save the settings</li>
                                        <li>Restart SAP GUI</li>
                                    </ol>
                                </div>
                            </div>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Troubleshooting:</strong> If you encounter COM interface or "Invalid class string" errors, try restarting SAP GUI, ensuring you have an active session open, or checking with your SAP administrator about scripting permissions. Some corporate SAP installations restrict scripting capabilities.
                            </div>
                        </div>
                        

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_scripts %}
{% endblock %}
{% endblock %}